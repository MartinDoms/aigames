<div th:fragment="game-settings">
    <h3 class="text-xl font-semibold text-primary mb-4 flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-primary" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
        </svg>
        Game Settings
    </h3>

    <div class="space-y-6" x-cloak x-show="isHost" x-data="{ gameMode: (rounds === 10 && roundLength === 60) ? '10-rounds' : (rounds === 1 && roundLength === 60) ? 'continuous' : 'custom' }">
        <form @submit.prevent="startGame" class="space-y-6">
            <div class="space-y-4">
                <h4 class="text-lg font-medium text-primary-dark mb-3">Choose Your Game Mode</h4>
                
                <div class="grid grid-cols-1 gap-4">
                    <!-- 10 Rounds Option -->
                    <button type="button" @click="gameMode = '10-rounds'; rounds = 10; roundLength = 60"
                            :class="gameMode === '10-rounds' ? 'border-primary bg-accent-light' : 'border-neutral-dark hover:border-accent-dark bg-primary'"
                            class="p-4 border-2 rounded-lg transition-all text-left">
                        <div class="flex items-center space-x-3">
                            <!-- Icon -->
                            <div class="flex-shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" :class="gameMode === '10-rounds' ? 'text-primary' : 'text-neutral'" class="h-8 w-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/>
                                    <line x1="4" y1="22" x2="4" y2="15"/>
                                </svg>
                            </div>
                            <div>
                                <h5 :class="gameMode === '10-rounds' ? 'text-primary' : 'text-neutral'" class="font-semibold text-lg">Rounds</h5>
                                <p :class="gameMode === '10-rounds' ? 'text-primary opacity-80' : 'text-neutral opacity-80'" class="text-sm">Play 10 rounds to compete for the top spot</p>
                            </div>
                        </div>
                    </button>
                    
                    <!-- Continuous Mode Option -->
                    <button type="button" @click="gameMode = 'continuous'; rounds = 1; roundLength = 60"
                            :class="gameMode === 'continuous' ? 'border-primary bg-accent-light' : 'border-neutral-dark hover:border-accent-dark bg-primary'"
                            class="p-4 border-2 rounded-lg transition-all text-left">
                        <div class="flex items-center space-x-3">
                            <!-- Icon -->
                            <div class="flex-shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" :class="gameMode === 'continuous' ? 'text-primary' : 'text-neutral'" class="h-8 w-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M8 18l4-4 4 4"/>
                                    <path d="M8 6l4 4 4-4"/>
                                    <circle cx="12" cy="12" r="10"/>
                                </svg>
                            </div>
                            <div>
                                <h5 :class="gameMode === 'continuous' ? 'text-primary' : 'text-neutral'" class="font-semibold text-lg">Continuous Mode</h5>
                                <p :class="gameMode === 'continuous' ? 'text-primary opacity-80' : 'text-neutral opacity-80'" class="text-sm">Play forever at 60 seconds per round - your scores don't accumulate between rounds</p>
                            </div>
                        </div>
                    </button>
                    
                    <!-- Custom Settings Option -->
                    <button type="button" @click="gameMode = 'custom'"
                            :class="gameMode === 'custom' ? 'border-primary bg-accent-light' : 'border-neutral-dark hover:border-accent-dark bg-primary'"
                            class="p-4 border-2 rounded-lg transition-all text-left">
                        <div class="flex items-center space-x-3">
                            <!-- Icon -->
                            <div class="flex-shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" :class="gameMode === 'custom' ? 'text-primary' : 'text-neutral'" class="h-8 w-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="3"/>
                                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                                </svg>
                            </div>
                            <div>
                                <h5 :class="gameMode === 'custom' ? 'text-primary' : 'text-neutral'" class="font-semibold text-lg">Custom</h5>
                                <p :class="gameMode === 'custom' ? 'text-primary opacity-80' : 'text-neutral opacity-80'" class="text-sm">Configure your own settings</p>
                            </div>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Custom Settings Expandable Section -->
            <div x-show="gameMode === 'custom'" 
                 x-transition:enter="transition ease-out duration-300"
                 x-transition:enter-start="opacity-0 max-h-0 overflow-hidden"
                 x-transition:enter-end="opacity-100 max-h-screen"
                 x-transition:leave="transition ease-in duration-200"
                 x-transition:leave-start="opacity-100 max-h-screen"
                 x-transition:leave-end="opacity-0 max-h-0 overflow-hidden"
                 class="space-y-6 bg-neutral-dark rounded-lg p-4 border border-accent">
                <!-- Number of Rounds -->
                <div class="space-y-2">
                    <label for="rounds" class="block text-sm font-medium text-primary-dark">Number of Rounds</label>
                    <div class="flex items-center">
                        <button type="button" @click="decrementRounds"
                                class="bg-accent text-primary px-3 py-1 rounded-l-md hover:bg-accent-dark transition">
                            -
                        </button>
                        <input type="number" id="rounds" x-model="rounds" min="1" max="20"
                               class="w-16 text-center border-y border-accent bg-neutral-light text-primary py-1 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none" />
                        <button type="button" @click="incrementRounds"
                                class="bg-accent text-primary px-3 py-1 rounded-r-md hover:bg-accent-dark transition">
                            +
                        </button>
                    </div>
                </div>

                <!-- Round Length -->
                <div class="space-y-2">
                    <label for="roundLength" class="block text-sm font-medium text-primary-dark">Round Length (seconds)</label>
                    <div class="flex items-center">
                        <button type="button" @click="decrementTime"
                                class="bg-accent text-primary px-3 py-1 rounded-l-md hover:bg-accent-dark transition">
                            -
                        </button>
                        <input type="number" id="roundLength" x-model="roundLength" min="10" max="120" step="5"
                               class="w-16 text-center border-y border-accent bg-neutral-light text-primary py-1 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none" />
                        <button type="button" @click="incrementTime"
                                class="bg-accent text-primary px-3 py-1 rounded-r-md hover:bg-accent-dark transition">
                            +
                        </button>
                    </div>
                </div>

                <!-- Geography Type -->
                <div class="space-y-2">
                    <label for="geoType" class="block text-sm font-medium text-primary-dark">Region Selection</label>
                    <select id="geoType" x-model="geoType"
                            class="w-full bg-neutral-light border border-accent rounded-md text-primary py-2 px-3 focus:outline-none focus:ring-2 focus:ring-accent">
                        <option value="WORLD">Whole World</option>
                        <option value="USA" disabled>USA (coming soon)</option>
                        <option value="ASIA" disabled>Asia (coming soon)</option>
                        <option value="EUROPE" disabled>Europe (coming soon)</option>
                        <option value="AUSTRALASIA" disabled>Australasia (coming soon)</option>
                        <option value="JAPAN" disabled>Japan (coming soon)</option>
                    </select>
                </div>
            </div>

            <div class="flex justify-center mt-8">
                <button type="submit"
                        class="inline-flex items-center px-6 py-3 bg-primary hover:bg-secondary-dark text-neutral font-bold rounded-lg shadow transition transform hover:scale-105">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
                    </svg>
                    Start Game
                </button>
            </div>
        </form>
    </div>

    <div x-show="!isHost" class="text-center py-4 text-primary-dark">
        Waiting for the lobby host to start the game...
    </div>
</div>